
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Basic simulation controls &#8212; ISOLDE 1.0b3.dev7 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Manipulating your model" href="rebuild.html" />
    <link rel="prev" title="Visualisation and Navigation" href="navigation.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="basic-simulation-controls">
<h1>Basic simulation controls<a class="headerlink" href="sim_settings.html#basic-simulation-controls" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="sim_settings.html#starting-a-simulation" id="id5">Starting a simulation</a></p></li>
<li><p><a class="reference internal" href="sim_settings.html#dealing-with-unrecognised-residues" id="id6">Dealing with unrecognised residues</a></p></li>
<li><p><a class="reference internal" href="sim_settings.html#dealing-with-severe-clashes" id="id7">Dealing with severe clashes</a></p></li>
<li><p><a class="reference internal" href="sim_settings.html#general-simulation-controls" id="id8">General simulation controls</a></p></li>
<li><p><a class="reference internal" href="sim_settings.html#basic-interaction" id="id9">Basic interaction</a></p></li>
<li><p><a class="reference internal" href="sim_settings.html#adjusting-map-weightings" id="id10">Adjusting map weightings</a></p></li>
<li><p><a class="reference internal" href="sim_settings.html#trajectory-smoothing" id="id11">Trajectory smoothing</a></p></li>
</ul>
</div>
<div class="section" id="starting-a-simulation">
<span id="id1"></span><h2><a class="toc-backref" href="sim_settings.html#id5">Starting a simulation</a><a class="headerlink" href="sim_settings.html#starting-a-simulation" title="Permalink to this headline">¶</a></h2>
<p>Assuming your model meets the reuqirements (that is, all residues are complete
with hydrogens and known to the MD forcefield), then starting a simulation is as
simple as making a selection of atoms in the main ChimeraX window and clicking
the play button in the bottom left of the ISOLDE panel (see below). Your
selection may be anything from a single atom to all atoms in the model, but for
the sake of performance should be as small as necessary to achieve the desired
goal. Of course, the larger the selection the slower the simulation.</p>
<p>The selection size you can make while still achieving reasonably interactive
performance is primarily dependent on your GPU (which does essentially all of
the hard work of running the simulation). As a general reference, my “big”
laptop (a gaming model with Intel Core i7 CPU and a NVidia GTX1070 GPU)
manages about 15-20 coordinate updates per second when simulating all 229
residues of the demonstration model, and maintains reasonably interactive
performance for up to a few thousand residues. Note that <em>graphics</em> performance
(that is, responsiveness of the display when rotating, translating, zooming
etc.) is only weakly affected by simulation size, and remains above 30 fps
under most circumstances. My (much) smaller MacBook Air still manages
surprisingly well. Not that I’d actually suggest seriously using such a small
machine for an entire job, but it gives usably interactive performance for a
few dozen residues at a time (sufficient for tweaking rotamers, loops etc.).</p>
<p>The maximum sized model that will successfully run <strong>non</strong> interactively is a
limit I have yet to find, but will typically be limited by the amount of RAM on
your GPU. I can tell you that simulations of the 3,792-residue 3ja8 with its
3.8Å map run successfully on both of the above machines. While in most cases
simulation of the entire model will be far too slow to use interactively, it is
nevertheless often necessary to run it for a few minutes prior to running any
interactive simulations on smaller selections, to ensure any bad clashes and
other very-high-energy states are relaxed out. <em>(NOTE: for very large models
and/or low-end hardware, initial minimisation of the entire model can take
anywhere up to tens of  minutes. Please be patient - once you see the atoms
start moving it is safe to  stop the simulation and continue working with more
manageable selections)</em></p>
<p>Before we go ahead and start a simulation, let’s talk briefly about what happens
to your initial selection when you press that play button. That’s controlled by
this dialogue on the <em>Sim settings</em> tab:</p>
<div class="figure align-default">
<img alt="Simulation selection expansion settings" src="../../_images/sim_selection_settings.png" />
</div>
<p>The first spinbox controls how the selection will be extended <em>along</em> the
chain(s), while the second controls how the resulting selection will be expanded
<em>outwards</em>. The steps taken are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The initial selection is expanded to complete residues (for any residue
in which <em>one</em> atom was selected, <em>all</em> are selected);</p></li>
<li><p>For all residues in linear chains (i.e. protein or nucleic acid), each
contiguous selection is extended forward and backward by the number of
residues given in the first spinbox, stopping at chain breaks.</p></li>
<li><p>Any residue for which any atom comes within the distance given in the
second spinbox from any atom in the selection defined by (2) is added to
the selection.</p></li>
<li><p>The selection defined by (3) contains all the residues that will be
mobile in the simulation. In addition, a shell of rigidly-fixed atoms
is added surrounding the mobile selection, to make sure all mobile atoms
maintain their physical context in the wider model.</p></li>
<li><p>If a distance restraint involves a mobile atom and a second atom which
<em>isn’t</em> in the mobile or fixed selections, the residue containing the
second atom is added to the fixed selection.</p></li>
</ol>
</div></blockquote>
<p>The default values are fine for most purposes, but feel free to play. Just keep
in mind that <em>very</em> small simulations with only a few mobile residues
surrounded by fixed atoms tend to be somewhat unstable, since they often have
no freedom to relax bad (high-energy) interactions.</p>
</div>
<div class="section" id="dealing-with-unrecognised-residues">
<h2><a class="toc-backref" href="sim_settings.html#id6">Dealing with unrecognised residues</a><a class="headerlink" href="sim_settings.html#dealing-with-unrecognised-residues" title="Permalink to this headline">¶</a></h2>
<p>If ISOLDE encounters a residue it does not recognise while preparing a
simulation, a dialog box like the following will appear:</p>
<div class="figure align-default">
<img alt="Unrecognised residue error dialog box" src="../../_images/unrecognised_residue_error.png" />
</div>
<p>Click <em>Exclude residue from simulations and retry</em> if you’re quite sure that the
residue is a non-standard one without AMBER parameters. The offending residue
will then be ignored for the purposes of all further simulations (but will still
be used for map calculations if working with live x-ray maps). If it is bonded
to any parameterised residues, they will be fixed in space to ensure the ignored
portion remains in context. <em>(NOTE: you will need to take particular care - e.g.
by using position  restraints - to ensure that surrounding mobile residues are
not pulled into the  density associated with ignored residues.)</em></p>
<p>If the residue is one that you think <em>should</em> be recognised by the force field,
try using the <em>Add hydrogens and retry</em> button. If you’re not sure, click
<em>Abort</em>. The view will be focused on the offending residue, allowing you to
inspect and diagnose the issue. <em>(NOTE:</em> <code class="docutils literal notranslate"><span class="pre">addh</span></code> <em>will occasionally add
spurious hydrogens to terminal residues - particularly N-terminal prolines
and 5’ nucleotides. In such cases, you can select the offending hydrogen with</em>
<strong>ctrl-click</strong> <em>and then use the command</em> <code class="docutils literal notranslate"><span class="pre">delete</span> <span class="pre">sel</span></code> <em>to remove it.)</em></p>
</div>
<div class="section" id="dealing-with-severe-clashes">
<span id="dealing-with-clashes"></span><h2><a class="toc-backref" href="sim_settings.html#id7">Dealing with severe clashes</a><a class="headerlink" href="sim_settings.html#dealing-with-severe-clashes" title="Permalink to this headline">¶</a></h2>
<p>In a molecular dynamics forcefield, a severe clash (that is, a large overlap of
the van der Waals radii of two non-bonded atoms) can easily yield energies in
the tens of millions of kilojoules per mole. Simply starting a dynamic
simulation with such a clash will yield nothing but a cloud of atoms flying off
to infinity in every direction. For this reason, ISOLDE runs an energy
minimisation at the start of every simulation. While the minimiser is generally
very good at resolving clashes, it can still fail in particularly severe cases
where sidechains are effectively “tangled”. If this happens, you will see the
following warning:</p>
<div class="figure align-default">
<img alt="Unresolvable clash warning dialog" src="../../_images/clash_warning.png" />
</div>
<p>Clicking <em>OK</em> will open the <em>Clashes</em> widget on the <em>Validate</em> tag, giving you
a list of atoms experiencing particularly large net forces. Clicking on an
entry will take you to the offending residue. Note that the simulation is still
initialised - in many cases the clash can be resolved by adjusting rotamers
via the <em>Rebuild</em> tab, at which point you can try continuing the simulation.
In this case, the culprit is a (somewhat artificial) stack of clashing Phe
residues:</p>
<div class="figure align-default">
<img alt="badly clashing sidechains" src="../../_images/clashing_phes.jpg" />
</div>
<p>After adjusting the offending sidechains back into density, the simulation
successfully continues:</p>
<div class="figure align-default">
<img alt="resolved clash" src="../../_images/clash_resolved.jpg" />
</div>
<p>For more complex cases (in particular, anything that requires deletion of
atoms), you’ll need to stop the simulation (see below). One possible remedy is
to temporarily truncate one or more sidechains to alanine (e.g. for
residue 208 on chain A of model 1: <code class="docutils literal notranslate"><span class="pre">delete</span> <span class="pre">#1/A:208&amp;sideonly&amp;~&#64;CB</span></code>). Don’t
forget to run <code class="docutils literal notranslate"><span class="pre">addh</span></code> after doing this! Remember that you can always add the
sidechains back once you have the backbone geometry under control (see
<a class="reference internal" href="getting_started.html#preparing-a-model"><span class="std std-ref">Preparing a model for simulation</span></a>). A more extreme solution is to delete one or more
entire residues (<code class="docutils literal notranslate"><span class="pre">delete</span> <span class="pre">#1/A:208</span></code>). In this case you’ll need to use some
external package to add them back later.</p>
</div>
<div class="section" id="general-simulation-controls">
<span id="general-sim-controls"></span><h2><a class="toc-backref" href="sim_settings.html#id8">General simulation controls</a><a class="headerlink" href="sim_settings.html#general-simulation-controls" title="Permalink to this headline">¶</a></h2>
<p>If you’re working with the demo model and you have the whole model selected,
you shouldn’t run into any of the above problems. Just go ahead and click the
play button, and let’s go through the rest of the buttons in this toolbar:</p>
<div class="figure align-default" id="id2">
<img alt="Simulation control toolbar" src="../../_images/simulation_controls.png" />
<p class="caption"><span class="caption-text">General simulation controls</span><a class="headerlink" href="sim_settings.html#id2" title="Permalink to this image">¶</a></p>
<div class="legend">
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><img alt="play" src="../../_images/play_icon.png" /> <img alt="pause" src="../../_images/pause_icon.png" /></p></td>
<td><p>If no simulation is running, starts one. If a simulation
<em>is</em> running, controls pause/resume.</p></td>
</tr>
<tr class="row-even"><td><p>Min/Equil</p></td>
<td><p>Switch the simulation between energy minimisation and
equilibration modes. (<em>NOTE: due to the way minimsation
works under the hood, minimisation is not very
interactive. A quite effective “interactive
minimisation” can be achieved by simply setting the
temperature to 0 Kelvin in equilibration mode</em>)</p></td>
</tr>
<tr class="row-odd"><td><p><img alt="temp" src="../../_images/thermometer.png" /></p></td>
<td><p>Set the simulation temperature in Kelvin. The default
100K provides enough thermal motion to help “jiggle”
atoms into more favourable conformations, without moving
so fast as to be hard to control. The temperature can
be adjusted to any value between 0 and 500K.</p></td>
</tr>
<tr class="row-even"><td><p><img alt="cpg" src="../../_images/checkpoint_green.png" /></p></td>
<td><p>Set a “checkpoint” for the current simulation.
A checkpoint is simply a snapshot of the current
simulation, including the atomic coordinates and the
states of all interactive restraints. You should
consider saving a checkpoint whenever you’re about to
embark on a tricky or tentative manipulation of your
model. Note that the checkpoint becomes invalid once
the simulation is stopped.</p></td>
</tr>
<tr class="row-odd"><td><p><img alt="cpr" src="../../_images/checkpoint_red.png" /></p></td>
<td><p>Return to the checkpoint you last saved, discarding all
subsequent changes. If you have not saved a checkpoint
yet, this will revert you to the start of the
simulation.</p></td>
</tr>
<tr class="row-even"><td><p><img alt="stopg" src="../../_images/stop_sign_green.png" /></p></td>
<td><p>Stop the simulation, keeping the current state.</p></td>
</tr>
<tr class="row-odd"><td><p><img alt="cps" src="../../_images/checkpoint_stop_red.png" /></p></td>
<td><p>Stop the simulation and revert to the last checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p><img alt="stopr" src="../../_images/stop_sign_red.png" /></p></td>
<td><p>Abort the simulation, discarding all chainges (this will
raise an “are you sure?” warning).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="basic-interaction">
<h2><a class="toc-backref" href="sim_settings.html#id9">Basic interaction</a><a class="headerlink" href="sim_settings.html#basic-interaction" title="Permalink to this headline">¶</a></h2>
<p>With your simulation running, <strong>right-click-and-drag</strong> on any heavy atom and
you should see it follow your mouse cursor, with a 3D green arrow showing the
direction of pull:</p>
<div class="figure align-default" id="id3">
<img alt="Tugging on a single atom" src="../../_images/tugging.png" />
<p class="caption"><span class="caption-text">Interactive tugging forces are shown like this green arrow</span><a class="headerlink" href="sim_settings.html#id3" title="Permalink to this image">¶</a></p>
</div>
<p>This mouse mode is set every time the simulation starts. You can still use the
buttons on the ChimeraX mouse modes toolbar to make the right mouse button do
other things (just avoid anything that actually adds or removes atoms while your
simulation is running), and come back to tugging using the ISOLDE tugging mouse
modes toolbar (at the bottom left of the ISOLDE panel):</p>
<div class="figure align-default" id="id4">
<img alt="ISOLDE's tugging modes toolbar" src="../../_images/tugging_toolbar.png" />
<p class="caption"><span class="caption-text">Available tugging modes</span><a class="headerlink" href="sim_settings.html#id4" title="Permalink to this image">¶</a></p>
<div class="legend">
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><img alt="tuga" src="../../_images/tug_atom.png" /></p></td>
<td><p><strong>right-click-and-drag</strong> tugs on a single non-hydrogen
atom.</p></td>
</tr>
<tr class="row-even"><td><p><img alt="tugr" src="../../_images/tug_residue.png" /></p></td>
<td><p><strong>right-click-and-drag</strong> tugs on all heavy atoms in a
residue. The total applied force is the same as when
tugging on a single atom, but is distributed across all
atoms in proportion to their mass.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="adjusting-map-weightings">
<h2><a class="toc-backref" href="sim_settings.html#id10">Adjusting map weightings</a><a class="headerlink" href="sim_settings.html#adjusting-map-weightings" title="Permalink to this headline">¶</a></h2>
<p>When any qualifying map is associated with the currently selected model, ISOLDE
automatically prepares it for MDFF and calculates a suitable weighting constant
(see <a class="reference internal" href="getting_started.html#adding-maps"><span class="std std-ref">Adding maps</span></a>). The default weighting is determined as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The map is masked to within 3Å of the model atoms</p></li>
<li><p>For each voxel within the mask, the linear gradient of the map density is
calculated.</p></li>
<li><p>The coupling constant is chosen such that (coupling constant) *
(80th percentile gradient) = (a heuristically determined scaling
constant).</p></li>
</ol>
</div></blockquote>
<p>The default weighting tends to work well for models that are still quite
imperfect, giving the atoms freedom to move while still maintaining control. If
you wish to adjust the weighting, you can do so for any given map using the
tools available under the <em>Show map settings dialog</em> button on the <em>Sim
settings</em> tab. In particular, as the model improves it often makes sense to
increase the weighting to more tightly optimise the fit. Keep an eye on your
model validation, however - overly-strong map weights will tend to introduce
unphysical distortions to the model as it strives to fit every last bit of
noise.</p>
</div>
<div class="section" id="trajectory-smoothing">
<h2><a class="toc-backref" href="sim_settings.html#id11">Trajectory smoothing</a><a class="headerlink" href="sim_settings.html#trajectory-smoothing" title="Permalink to this headline">¶</a></h2>
<p>Molecular dynamics simulations are designed to closely replicate real-world
behaviour of molecules, including random thermal motion. While this is often
quite helpful in that it helps the model “rattle” into the map, the
high frequency frame-to-frame random jitters can become distracting to watch.
By default, ISOLDE therefore provides a smoothed visualisation of the evolving
trajectory, which can be turned on/off and/or adjusted using the button and dial
found at the middle bottom of the ISOLDE widget:</p>
<div class="figure align-default">
<img alt="Trajectory smoothing controls" src="../../_images/trajectory_smoothing.png" />
</div>
<p><strong>(IMPORTANT NOTE: Smoothing has no effect whatsoever on the simulation itself,
just on how you see it.)</strong></p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../isolde.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../isolde.html">Home</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ISOLDE.html">The ISOLDE GUI</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">What is ISOLDE all about?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../requirements.html">System Requirements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">GUI Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/isolde.html">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../commands/isolde.html">The ISOLDE Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/isolde.html">ISOLDE Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing ISOLDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact Info</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../isolde.html">Documentation overview</a><ul>
  <li><a href="../ISOLDE.html">The ISOLDE GUI</a><ul>
  <li><a href="index.html">GUI Details</a><ul>
      <li>Previous: <a href="navigation.html" title="previous chapter">Visualisation and Navigation</a></li>
      <li>Next: <a href="rebuild.html" title="next chapter">Manipulating your model</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016-2019, Tristan Croll.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/tools/gui/sim_settings.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>